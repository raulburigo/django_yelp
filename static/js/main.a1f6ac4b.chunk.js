(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{19:function(e,t,a){e.exports=a(42)},42:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),l=a.n(c),s=a(8),o=a(1),u=a.n(o),i=a(4),m=a(2),d=a(7),p=a.n(d);p.a.defaults.xsrfCookieName="csrftoken",p.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var f=p.a.create({baseURL:"https://yelp-like-app.herokuapp.com/api/v1/restaurants/"}),v=Object(n.createContext)(),E=function(e){var t=Object(n.useState)([]),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)([]),d=Object(m.a)(o,2),p=d[0],E=d[1],b=Object(n.useState)(!0),h=Object(m.a)(b,2),g=h[0],w=h[1];Object(n.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.get("");case 2:t=e.sent,l(t.data.data.restaurants);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){return console.log(e)})),w(!0)}),[l,g]);return r.a.createElement(v.Provider,{value:{restaurants:c,setRestaurants:l,addRestaurant:function(e){l([].concat(Object(s.a)(c),[e]))},addReview:function(e){E([].concat(Object(s.a)(p),[e]))},newReviews:p,setIsUpdated:w,isUpdated:g}},e.children)};var b=function(){var e=Object(n.useContext)(v).addRestaurant,t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(""),o=Object(m.a)(s,2),d=o[0],p=o[1],E=Object(n.useState)("Price Range"),b=Object(m.a)(E,2),h=b[0],g=b[1],w=function(){var t=Object(i.a)(u.a.mark((function t(a){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),"Price Range"!==h){t.next=5;break}alert("You forgot to select the price range"),t.next=19;break;case 5:return t.prev=5,t.next=8,f.post("",{name:c,location:d,price_range:h});case 8:n=t.sent,e(n.data.data.restaurant),l(""),p(""),g("Price Range"),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(5),console.log(t.t0),400===t.t0.response.status&&"The fields name, location must make a unique set."===t.t0.response.data.non_field_errors[0]&&alert("There already is a restaurant with this name in this location");case 19:case"end":return t.stop()}}),t,null,[[5,15]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"mb-4"},r.a.createElement("form",{onSubmit:w},r.a.createElement("div",{className:"form-row mx-auto"},r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control",type:"text",required:!0,placeholder:"name",value:c,onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",{className:"col"},r.a.createElement("input",{className:"form-control",type:"text",required:!0,placeholder:"location",value:d,onChange:function(e){return p(e.target.value)}})),r.a.createElement("div",{className:"col"},r.a.createElement("select",{className:"custom-select",value:h,onChange:function(e){return g(e.target.value)}},r.a.createElement("option",{disabled:!0},"Price Range"),r.a.createElement("option",{value:"1"},"$"),r.a.createElement("option",{value:"2"},"$$"),r.a.createElement("option",{value:"3"},"$$$"),r.a.createElement("option",{value:"4"},"$$$$"),r.a.createElement("option",{value:"5"},"$$$$$"))),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Add"))))};var h=function(e){for(var t=e.rating,a=[],c="fas fa-star text-warning",l="fas fa-star-half-alt text-warning",s="far fa-star text-warning",o=1;o<=5;o++)o<=t?a.push(r.a.createElement("i",{key:o,className:c})):o-t<=.5?a.push(r.a.createElement("i",{key:o,className:l})):a.push(r.a.createElement("i",{key:o,className:s}));return r.a.createElement(n.Fragment,null,a)};var g=function(){var e=Object(n.useContext)(v),t=e.restaurants,a=e.setRestaurants,c=function(){var e=Object(i.a)(u.a.mark((function e(n,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.prev=1,e.next=4,f.delete("/".concat(r));case 4:a(t.filter((function(e){return e.id!==r}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-hover table-dark"},r.a.createElement("thead",null,r.a.createElement("tr",{className:"bg-primary"},r.a.createElement("th",{scope:"col"},"Restaurant"),r.a.createElement("th",{scope:"col"},"Location"),r.a.createElement("th",{scope:"col"},"Price Range"),r.a.createElement("th",{scope:"col"},"Ratings"),r.a.createElement("th",{className:"d-none d-md-table-cell",scope:"col"},"Edit"),r.a.createElement("th",{className:"d-none d-md-table-cell",scope:"col"},"Delete"))),r.a.createElement("tbody",null,t&&t.map((function(e){return r.a.createElement("tr",{key:e.id,onClick:function(){return t=e.id,void(window.location.href="/restaurants/".concat(t));var t}},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.location),r.a.createElement("td",null,"$".repeat(e.price_range)),e.count>0?r.a.createElement("td",null,r.a.createElement(h,{rating:e.avg_rating}),r.a.createElement("span",{className:"text-warning"},"(",e.count,")")):r.a.createElement("td",null,r.a.createElement("span",{className:"text-warning"},"no reviews")),r.a.createElement("td",{className:"d-none d-md-table-cell"},r.a.createElement("button",{onClick:function(t){return function(e,t){e.stopPropagation(),window.location.href="/restaurants/".concat(t,"/update")}(t,e.id)},className:"btn btn-warning"},"Update")),r.a.createElement("td",{className:"d-none d-md-table-cell"},r.a.createElement("button",{onClick:function(t){return c(t,e.id)},className:"btn btn-danger"},"Delete")))})))))};var w=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"my-3 text-center"},r.a.createElement("h1",{className:"font-weight-light display-3"},"Restaurant Finder")),r.a.createElement(b,null),r.a.createElement(g,null))};var N=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(0),o=Object(m.a)(s,2),d=o[0],p=o[1],E=e.id,b=Object(n.useContext)(v).addReview,h=r.a.createElement("i",{className:"fas fa-star"}),g=r.a.createElement("i",{className:"far fa-star"}),w=function(){var e=Object(i.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==d){e.next=5;break}alert("You must give at least one star"),e.next=18;break;case 5:return e.prev=5,e.next=8,f.post("".concat(E,"/addreview/"),{review:c,rating:d});case 8:a=e.sent,b(a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0),e.t0.response&&403===e.t0.response.status?!0===window.confirm("You must log in to add reviews")&&(window.location.href="/accounts/login"):400===e.t0.response.status&&e.t0.response&&"The fields user, restaurant must make a unique set."===e.t0.response.data.non_field_errors[0]&&alert("You already reviewd this restaurant");case 16:l(""),p(0);case 18:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"mb-2"},r.a.createElement("form",{onSubmit:w},r.a.createElement("h2",{className:"border-bottom"},"New review"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col-md-3"},r.a.createElement("label",{htmlFor:"rating"},"Rating"),r.a.createElement("div",null,r.a.createElement("span",{onClick:function(){return p(1)},value:1},d>=1?h:g),r.a.createElement("span",{onClick:function(){return p(2)},value:2},d>=2?h:g),r.a.createElement("span",{onClick:function(){return p(3)},value:3},d>=3?h:g),r.a.createElement("span",{onClick:function(){return p(4)},value:4},d>=4?h:g),r.a.createElement("span",{onClick:function(){return p(5)},value:5},d>=5?h:g)))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"review"},"Review"),r.a.createElement("textarea",{required:!0,id:"review",value:c,onChange:function(e){return l(e.target.value)},className:"form-control"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-small"},"Add Review")))};var x=function(e){var t=e.reviews;return r.a.createElement("div",{className:"row row-cols-3 mb-2"},t&&t.map((function(e){return r.a.createElement("div",{key:e.id,className:"card text-white bg-primary mb-3 mr-4",style:{maxWidth:"30%"}},r.a.createElement("div",{className:"card-header d-flex justify-content-between"},r.a.createElement("span",{style:{fontWeight:"600"}},e.name),r.a.createElement("span",null,r.a.createElement(h,{rating:e.rating}))),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{className:"card-text"},e.review)))})))};var j=function(e){var t=e.id,a=Object(n.useState)({}),c=Object(m.a)(a,2),l=c[0],s=c[1],o=Object(n.useContext)(v).newReviews;return Object(n.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.get("".concat(t));case 2:a=e.sent,s(a.data.data.restaurant);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){console.log(e),e.response&&404===e.response.status&&s({name:"notfound",location:"nowhere"})}))}),[t,o]),r.a.createElement(n.Fragment,null,l&&("notfound"===l.name&&"nowhere"===l.location?r.a.createElement("h3",{className:"text-center text-danger mt-4"},"404 - restaurant not found"):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"my-3 text-center"},r.a.createElement("h1",{className:"font-weight-light display-3"},l.name),l.count>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{rating:l.avg_rating}),r.a.createElement("span",null," (".concat(l.count,") | "))):r.a.createElement("span",null,"no reviews yet | "),r.a.createElement("button",{type:"button",onClick:function(){window.location.href="/restaurants/".concat(l.id,"/update")},className:"btn btn-sm btn-outline-dark"},"update restaurant")),r.a.createElement(x,{reviews:l.reviews}),r.a.createElement(N,{id:t}))))};var O=function(e){var t=e.id,a=Object(n.useState)(""),c=Object(m.a)(a,2),l=c[0],s=c[1],o=Object(n.useState)(""),d=Object(m.a)(o,2),p=d[0],E=d[1],b=Object(n.useState)("Price Range"),h=Object(m.a)(b,2),g=h[0],w=h[1],N=Object(n.useState)(null),x=Object(m.a)(N,2),j=x[0],O=x[1],y=Object(n.useContext)(v).setIsUpdated;Object(n.useEffect)((function(){function e(){return(e=Object(i.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.get("".concat(t));case 2:a=e.sent,s(a.data.data.restaurant.name),E(a.data.data.restaurant.location),w(a.data.data.restaurant.price_range);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){console.log(e),e.response&&404===e.response.status&&O(404)}))}),[t]);var k=function(){var e=Object(i.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,f.put("".concat(t,"/"),{name:l,location:p,price_range:g});case 4:y(!1),window.location.href="/",e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,404!==j?r.a.createElement("form",{onSubmit:k},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Name"),r.a.createElement("input",{className:"form-control",type:"text",required:!0,placeholder:"restaurant name",value:l,onChange:function(e){return s(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"location"},"Location"),r.a.createElement("input",{className:"form-control",type:"text",required:!0,placeholder:"restaurant location",value:p,onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"price_range"},"Price Range"),r.a.createElement("select",{className:"custom-select",value:g,onChange:function(e){return w(e.target.value)}},r.a.createElement("option",{disabled:!0},"Price Range"),r.a.createElement("option",{value:"1"},"$"),r.a.createElement("option",{value:"2"},"$$"),r.a.createElement("option",{value:"3"},"$$$"),r.a.createElement("option",{value:"4"},"$$$$"),r.a.createElement("option",{value:"5"},"$$$$$"))),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Update")):r.a.createElement("h3",{className:"text-center text-danger"},"404 - restaurant not found"))};var y=function(e){return r.a.createElement("div",{className:"my-3 text-center"},r.a.createElement("h1",null,"Update Restaurant"),r.a.createElement(O,{id:e.id}))},k=function(e){var t=e.data,a=t.page,n=t.restaurant_id,c=null;switch(a){case"home":c=r.a.createElement(w,null);break;case"detail":c=r.a.createElement(j,{id:n});break;case"update":c=r.a.createElement(y,{id:n})}return r.a.createElement(E,null,r.a.createElement("div",{className:"container"},c))},$=document.getElementById("root");l.a.render(r.a.createElement(k,{data:$.dataset}),$)}},[[19,1,2]]]);
//# sourceMappingURL=main.a1f6ac4b.chunk.js.map